{% extends 'base.html' %}
{% block content %}

{% if no_results > 0 %}
    We have searched your area: {{ area }}<br>
    <br>
    <br>
    {% if not area_trend %}
        The median property price is ${{ median_price[1]  }}.<br>
        <br>
    {% endif %}
    The 25% percentile price is ${{  percent_25_price[1]  }}.<br>
    <br>
    The 75% percentile price is ${{  percent_75_price[1]  }}.
    <br>
    <br>
    <br>
    <!-- {% if area_trend %}
    {% for key, value in area_trend.items() %}

        Year {{ key }}, average price {{ value[0] }}, home count {{ value[1] }}, median price {{ value[2] }}.<br>
        <br>
    {% endfor %}
    {% endif %} -->
    <button type="button", id='saved-search', value = "{{ search_params }}" > Save this search</button>
{% else %}

    Sorry, no results, please search again.<br>
{% endif %}

<input id="region_sales" value="{{ area_trend }}" hidden>

{% if area_trend != 0 %}
<div class="line-chart">
  <canvas id="lineChart"></canvas>
  <div id="lineLegend" class="chart-legend"></div>
</div>

{% endif %}
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.1/Chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.js"></script>
<script>
    "use strict";

    function handleSave(evt) {
        let search_url = document.URL
        let search_params = document.getElementById("saved-search").value;
        console.log(search_params)
        $.post('/search', {save_type : "search", save_data: search_params, searches_url: search_url }, function (data) {
            $('#saved-search').text('Search saved');
            $('#saved-search').attr('disabled', true);
            console.log(data);
        });
    }

    $('#saved-search').on('click', handleSave);

</script>
<script src="../static/region-sales-history.js"></script>

{% endblock %}