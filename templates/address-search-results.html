<!DOCTYPE html>

{% extends 'base.html' %}
{% block content %}



<head>
    <style type="text/css">
        html, body { height: 100%; margin: 0; padding: 0; }
        #map { height: 100%; }
    </style>
</head>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src= "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.1/Chart.js"></script>
<body>

Property ID: {{  address_params.property_id }}<br>
Address: {{  address_params.address }}<br>
County: {{ address_params.county  }}<br>
Wall Type: {{ address_params.wall_type }}<br>
Building Type: {{ address_params.bldg_type  }}<br>
Property Size: {{address_params.prop_size}}<br>
Lot Size: {{ address_params.lot_size }}<br>
Year Built: {{ address_params.year_built }}<br>
Last Modified: {{ address_params.last_modified }}<br>
<br>
<br>
<br>
<br>
<div id='sale_history' value = "{{ sale_history }}">
  <!-- 
        <ul>
            {% if sale_history != 0 %}
                {% for i,sale in sale_history.items() %}
                <li>
                    Sale Date: {{  i  }}   Price: ${{  sale  }}
                </li>
                {% endfor %}
            {% else %}
                No sales data available for this address.

            {% endif %}
        </ul> -->
</div>
{% if sale_history != 0 %}
Sales Details:

<div class="line-chart">
  <canvas id="lineChart"></canvas>
  <div id="lineLegend" class="chart-legend"></div>
</div>
{% endif %}

<div>
    <button type="button", id='saved-property', value = "{{ address_params }}"> Save this property
</div>

<script>
    "use strict";

    function handleSave(evt) {
        let address_params = document.getElementById("saved-property").value;
        $.post('/search', {save_type : "address",save_data: address_params}, function (data) {
            $('#saved-property').text('Property Saved.');
            $('#saved-property').attr('disabled', true);
            console.log(data);
        });
    }

    $('#saved-property').on('click', handleSave);

</script>

<input id="propertymap" value="{{ address_params }}" hidden>
<input id="saleshistory" value="{{ sale_history }}" hidden>
<br>
<br>
<div id="map"></div>

    <!-- Google maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>

    <!-- what it looks like with a key -->
<!-- <script async defer
//       src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE&callback=initMap">
</script> -->

    <script src="../static/googlemaps.js"></script>
    <script src="../static/address-sales-history.js"></script>
    
</body>
{% endblock %}


